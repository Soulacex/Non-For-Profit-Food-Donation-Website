{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { LoginComponent } from 'src/app/login/login.component';\nexport let HelperPageComponent = class HelperPageComponent {\n  constructor(helperService, adminService, cupboardService, notificationService) {\n    this.helperService = helperService;\n    this.adminService = adminService;\n    this.cupboardService = cupboardService;\n    this.notificationService = notificationService;\n    this.cupboardNeeds = [];\n    this.fundingBasket = [];\n    this.supportedNeeds = [];\n    this.searchTerm = '';\n    this.currentUser = '';\n  }\n  ngOnInit() {\n    this.getCupboardNeeds();\n    this.currentUser = LoginComponent.currentUser;\n  }\n  getCupboardNeeds() {\n    this.adminService.getNeeds().subscribe(needs => this.cupboardNeeds = needs);\n  }\n  searchCupboardNeeds() {\n    this.cupboardService.searchPartialName(this.searchTerm).subscribe(needs => this.cupboardNeeds = needs);\n  }\n  resetCupboardSearch() {\n    this.searchTerm = '';\n    this.getCupboardNeeds();\n  }\n  addToBasket(cupboardNeed) {\n    if (cupboardNeed.quantity > 0) {\n      this.helperService.addSupportedNeed(cupboardNeed).subscribe(addedNeed => {\n        const originalBasketIndex = this.supportedNeeds.findIndex(n => n.name === addedNeed.name);\n        if (originalBasketIndex !== -1) {\n          this.supportedNeeds[originalBasketIndex].quantity += 1;\n        } else {\n          this.supportedNeeds.push({\n            name: addedNeed.name,\n            cost: addedNeed.cost,\n            type: addedNeed.type,\n            quantity: 1\n          });\n        }\n        const foundNeed = this.cupboardNeeds.find(n => n.name === cupboardNeed.name);\n        if (foundNeed) {\n          foundNeed.quantity -= 1;\n        }\n        const message = `Adding need to the basket`;\n        alert(message);\n      }, error => {\n        console.error(error);\n        const message = `Error adding need to the basket`;\n        alert(message);\n      });\n    } else {\n      const message = `Cannot add need to the basket since the quantity is already at 0.`;\n      alert(message);\n    }\n  }\n  removeFromBasket(need) {\n    this.helperService.removeSupportedNeed(need.name).subscribe(_ => {\n      const originalNeed = this.cupboardNeeds.find(n => n.name === need.name);\n      if (originalNeed) {\n        originalNeed.quantity += 1;\n        this.supportedNeeds = this.supportedNeeds.filter(n => n.name !== need.name);\n        const message = `Removing need from basket`;\n        alert(message);\n        this.cupboardService.removeFromBasket(need);\n      } else {\n        const message = `Original need not found in cupboard`;\n        alert(message);\n      }\n    }, error => {\n      console.error(error);\n      const message = `Error removing need from basket`;\n      alert(message);\n    });\n  }\n  checkout() {\n    this.helperService.checkOut().subscribe(_ => {\n      this.supportedNeeds = [];\n      this.getCupboardNeeds();\n      const message = 'Checkout Successful!';\n      alert(message);\n    }, error => {\n      console.error(error);\n      const message = 'Error during checkout';\n      alert(message);\n    });\n  }\n  createNotification() {\n    let username = this.currentUser;\n    if (this.fundingBasket.length != 0) {\n      this.fundingBasket.forEach(fundneed => this.notificationService.createNotification({\n        username,\n        \"need\": fundneed.name,\n        \"quantity\": fundneed.quantity\n      }));\n    }\n  }\n};\nHelperPageComponent = __decorate([Component({\n  selector: 'app-helper-page',\n  templateUrl: './helper-page.component.html',\n  styleUrls: ['./helper-page.component.scss']\n})], HelperPageComponent);","map":{"version":3,"names":["Component","LoginComponent","HelperPageComponent","constructor","helperService","adminService","cupboardService","notificationService","cupboardNeeds","fundingBasket","supportedNeeds","searchTerm","currentUser","ngOnInit","getCupboardNeeds","getNeeds","subscribe","needs","searchCupboardNeeds","searchPartialName","resetCupboardSearch","addToBasket","cupboardNeed","quantity","addSupportedNeed","addedNeed","originalBasketIndex","findIndex","n","name","push","cost","type","foundNeed","find","message","alert","error","console","removeFromBasket","need","removeSupportedNeed","_","originalNeed","filter","checkout","checkOut","createNotification","username","length","forEach","fundneed","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\samue\\SWEN261\\team-project-2231-swen-261-07-7-g-fundsinhighplaces\\ufund-ui\\UFund-Store\\src\\app\\helper\\helper-page\\helper-page.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Needs } from 'src/app/needs';\r\nimport { HelperService } from 'src/app/helper.service';\r\nimport { Cupboard } from 'src/app/cupboard.service';\r\nimport { LoginComponent } from 'src/app/login/login.component';\r\nimport { Notification } from 'src/app/notification';\r\nimport { NotificationService } from 'src/app/notification.service';\r\nimport { AdminService } from 'src/app/admin.service';\r\n\r\n@Component({\r\n  selector: 'app-helper-page',\r\n  templateUrl: './helper-page.component.html',\r\n  styleUrls: ['./helper-page.component.scss']\r\n})\r\nexport class HelperPageComponent implements OnInit {\r\n\r\n  cupboardNeeds: Needs[] = [];\r\n  fundingBasket: Needs[] = [];\r\n  supportedNeeds: Needs[] = [];\r\n  selectedNeed?: Needs;\r\n  searchTerm: string = '';\r\n  currentUser: string = '';\r\n\r\n  constructor(private helperService: HelperService, private adminService: AdminService, private cupboardService: CupboardService,\r\n    private notificationService: NotificationService) {}\r\n\r\n  ngOnInit(): void {\r\n    this.getCupboardNeeds();\r\n    this.currentUser = LoginComponent.currentUser\r\n  }\r\n\r\n  getCupboardNeeds(): void {\r\n    this.adminService.getNeeds().subscribe(needs => this.cupboardNeeds = needs);\r\n  }\r\n\r\n\r\n  searchCupboardNeeds(): void {\r\n    this.cupboardService.searchPartialName(this.searchTerm).subscribe(needs => this.cupboardNeeds = needs);\r\n  }\r\n\r\n  resetCupboardSearch(): void {\r\n    this.searchTerm = '';\r\n    this.getCupboardNeeds();\r\n  }\r\n\r\n  addToBasket(cupboardNeed: Needs): void {\r\n    if (cupboardNeed.quantity > 0) {\r\n      this.helperService.addSupportedNeed(cupboardNeed).subscribe(\r\n        (addedNeed: Needs) => {\r\n          const originalBasketIndex = this.supportedNeeds.findIndex(n => n.name === addedNeed.name);\r\n          if (originalBasketIndex !== -1) {\r\n            this.supportedNeeds[originalBasketIndex].quantity += 1;\r\n          } else {\r\n            this.supportedNeeds.push({\r\n              name: addedNeed.name,\r\n              cost: addedNeed.cost,\r\n              type: addedNeed.type,\r\n              quantity: 1,\r\n            });\r\n          }\r\n  \r\n          const foundNeed = this.cupboardNeeds.find(n => n.name === cupboardNeed.name);\r\n          if (foundNeed) {\r\n            foundNeed.quantity -= 1;\r\n          }\r\n  \r\n          const message = `Adding need to the basket`;\r\n          alert(message);\r\n  \r\n        },\r\n        error => {\r\n          console.error(error);\r\n          const message = `Error adding need to the basket`;\r\n          alert(message);\r\n        }\r\n      );\r\n    } else {\r\n      const message = `Cannot add need to the basket since the quantity is already at 0.`;\r\n      alert(message);\r\n    }\r\n  }  \r\n\r\n  removeFromBasket(need: Needs): void {\r\n    this.helperService.removeSupportedNeed(need.name).subscribe(\r\n      _ => {\r\n        const originalNeed = this.cupboardNeeds.find(n => n.name === need.name);\r\n        if (originalNeed) {\r\n          originalNeed.quantity += 1;\r\n\r\n          this.supportedNeeds = this.supportedNeeds.filter(n => n.name !== need.name);\r\n\r\n          const message = `Removing need from basket`;\r\n          alert(message);\r\n\r\n          this.cupboardService.removeFromBasket(need);\r\n        } else {\r\n          const message = `Original need not found in cupboard`;\r\n          alert(message);\r\n        }\r\n      },\r\n      error => {\r\n        console.error(error);\r\n        const message = `Error removing need from basket`;\r\n        alert(message);\r\n      }\r\n    );\r\n  }\r\n\r\n  checkout(): void {\r\n    this.helperService.checkOut().subscribe(\r\n      _ => {\r\n        this.supportedNeeds = [];\r\n        this.getCupboardNeeds();\r\n\r\n        const message = 'Checkout Successful!';\r\n        alert(message);\r\n      },\r\n      error => {\r\n        console.error(error);\r\n        const message = 'Error during checkout';\r\n        alert(message);\r\n      }\r\n    );\r\n  }\r\n\r\n  createNotification(){\r\n    let username = this.currentUser\r\n    if(this.fundingBasket.length!=0){\r\n      this.fundingBasket.forEach(fundneed => \r\n      this.notificationService.createNotification\r\n      ({username,\"need\": fundneed.name,\"quantity\": fundneed.quantity} as Notification));\r\n    }\r\n  }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}