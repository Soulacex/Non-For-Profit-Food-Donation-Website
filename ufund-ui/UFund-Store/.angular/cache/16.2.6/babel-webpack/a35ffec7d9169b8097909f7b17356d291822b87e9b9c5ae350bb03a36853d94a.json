{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { LoginComponent } from 'src/app/login/login.component';\nexport let HelperPageComponent = class HelperPageComponent {\n  constructor(helperService, cupboardService, messageService) {\n    this.helperService = helperService;\n    this.cupboardService = cupboardService;\n    this.messageService = messageService;\n    this.cupboardNeeds = [];\n    this.fundingBasket = [];\n    this.supportedNeeds = [];\n    this.searchTerm = '';\n    this.currentUser = '';\n  }\n  ngOnInit() {\n    this.getCupboardNeeds();\n    this.currentUser = LoginComponent.currentUser;\n  }\n  getCupboardNeeds() {\n    this.helperService.getAllNeeds().subscribe(needs => {\n      this.cupboardNeeds = needs;\n    }, error => {\n      console.error(error);\n    });\n  }\n  searchCupboardNeeds() {\n    if (!this.searchTerm.trim()) {\n      this.getCupboardNeeds();\n      return;\n    }\n    this.helperService.searchPartialName(this.searchTerm).subscribe(filteredNeeds => {\n      this.cupboardNeeds = filteredNeeds;\n    }, error => {\n      console.error(error);\n    });\n  }\n  resetCupboardSearch() {\n    this.searchTerm = '';\n    this.getCupboardNeeds();\n  }\n  addToBasket(cupboardNeed) {\n    if (cupboardNeed.quantity > 0) {\n      this.helperService.addSupportedNeed(cupboardNeed).subscribe(addedNeed => {\n        const originalBasketIndex = this.supportedNeeds.findIndex(n => n.name === addedNeed.name);\n        if (originalBasketIndex !== -1) {\n          this.supportedNeeds[originalBasketIndex].quantity += 1;\n        } else {\n          this.supportedNeeds.push({\n            name: addedNeed.name,\n            cost: addedNeed.cost,\n            type: addedNeed.type,\n            quantity: 1\n          });\n        }\n        const foundNeed = this.cupboardNeeds.find(n => n.name === cupboardNeed.name);\n        if (foundNeed) {\n          foundNeed.quantity -= 1;\n        }\n        const message = `Adding need to the basket`;\n        alert(message);\n      }, error => {\n        console.error(error);\n        const message = `Error adding need to the basket`;\n        alert(message);\n      });\n    } else {\n      const message = `Cannot add need to the basket since the quantity is already at 0.`;\n      alert(message);\n    }\n  }\n  removeFromBasket(need) {\n    this.helperService.removeSupportedNeed(need.name).subscribe(_ => {\n      const originalNeed = this.cupboardNeeds.find(n => n.name === need.name);\n      if (originalNeed) {\n        originalNeed.quantity += 1;\n        this.supportedNeeds = this.supportedNeeds.filter(n => n.name !== need.name);\n        const message = `Removing need from basket`;\n        alert(message);\n        this.cupboardService.removeFromBasket(need);\n      } else {\n        const message = `Original need not found in cupboard`;\n        alert(message);\n      }\n    }, error => {\n      console.error(error);\n      const message = `Error removing need from basket`;\n      alert(message);\n    });\n  }\n  checkout() {\n    this.helperService.checkOut().subscribe(_ => {\n      this.supportedNeeds = [];\n      this.getCupboardNeeds();\n      const message = 'Checkout Successful!';\n      alert(message);\n    }, error => {\n      console.error(error);\n      const message = 'Error during checkout';\n      alert(message);\n    });\n  }\n  addHelperMessage(message) {\n    let username = this.currentUser;\n    username = username.trim();\n    message = message.trim();\n    if (!message) {\n      return;\n    }\n    this.messageService.addMessage({\n      username,\n      message\n    }).subscribe();\n  }\n};\nHelperPageComponent = __decorate([Component({\n  selector: 'app-helper-page',\n  templateUrl: './helper-page.component.html',\n  styleUrls: ['./helper-page.component.scss']\n})], HelperPageComponent);","map":{"version":3,"names":["Component","LoginComponent","HelperPageComponent","constructor","helperService","cupboardService","messageService","cupboardNeeds","fundingBasket","supportedNeeds","searchTerm","currentUser","ngOnInit","getCupboardNeeds","getAllNeeds","subscribe","needs","error","console","searchCupboardNeeds","trim","searchPartialName","filteredNeeds","resetCupboardSearch","addToBasket","cupboardNeed","quantity","addSupportedNeed","addedNeed","originalBasketIndex","findIndex","n","name","push","cost","type","foundNeed","find","message","alert","removeFromBasket","need","removeSupportedNeed","_","originalNeed","filter","checkout","checkOut","addHelperMessage","username","addMessage","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\samue\\SWEN261\\team-project-2231-swen-261-07-7-g-fundsinhighplaces\\ufund-ui\\UFund-Store\\src\\app\\helper\\helper-page\\helper-page.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Needs } from 'src/app/needs';\r\nimport { HelperService } from 'src/app/helper.service';\r\nimport { Cupboard } from 'src/app/cupboard.service';\r\nimport { LoginComponent } from 'src/app/login/login.component';\r\nimport { HelperMessage } from 'src/app/HelperMessage';\r\nimport { HelperMessageService } from 'src/app/helper-message.service';\r\n\r\n@Component({\r\n  selector: 'app-helper-page',\r\n  templateUrl: './helper-page.component.html',\r\n  styleUrls: ['./helper-page.component.scss']\r\n})\r\nexport class HelperPageComponent implements OnInit {\r\n\r\n  cupboardNeeds: Needs[] = [];\r\n  fundingBasket: Needs[] = [];\r\n  supportedNeeds: Needs[] = [];\r\n  selectedNeed?: Needs;\r\n  searchTerm: string = '';\r\n  currentUser: string = '';\r\n\r\n  constructor(private helperService: HelperService, private cupboardService: Cupboard, private messageService: HelperMessageService) {}\r\n\r\n  ngOnInit(): void {\r\n    this.getCupboardNeeds();\r\n    this.currentUser = LoginComponent.currentUser\r\n  }\r\n\r\n  getCupboardNeeds(): void {\r\n    this.helperService.getAllNeeds().subscribe(\r\n      (needs: Needs[]) => {\r\n        this.cupboardNeeds = needs;\r\n      },\r\n      (error: any) => {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n\r\n  searchCupboardNeeds(): void {\r\n    if (!this.searchTerm.trim()) {\r\n      this.getCupboardNeeds();\r\n      return;\r\n    }\r\n\r\n    this.helperService.searchPartialName(this.searchTerm).subscribe(\r\n      (filteredNeeds: Needs[]) => {\r\n        this.cupboardNeeds = filteredNeeds;\r\n      },\r\n      (error: any) => {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  resetCupboardSearch(): void {\r\n    this.searchTerm = '';\r\n    this.getCupboardNeeds();\r\n  }\r\n\r\n  addToBasket(cupboardNeed: Needs): void {\r\n    if (cupboardNeed.quantity > 0) {\r\n      this.helperService.addSupportedNeed(cupboardNeed).subscribe(\r\n        (addedNeed: Needs) => {\r\n          const originalBasketIndex = this.supportedNeeds.findIndex(n => n.name === addedNeed.name);\r\n          if (originalBasketIndex !== -1) {\r\n            this.supportedNeeds[originalBasketIndex].quantity += 1;\r\n          } else {\r\n            this.supportedNeeds.push({\r\n              name: addedNeed.name,\r\n              cost: addedNeed.cost,\r\n              type: addedNeed.type,\r\n              quantity: 1,\r\n            });\r\n          }\r\n  \r\n          const foundNeed = this.cupboardNeeds.find(n => n.name === cupboardNeed.name);\r\n          if (foundNeed) {\r\n            foundNeed.quantity -= 1;\r\n          }\r\n  \r\n          const message = `Adding need to the basket`;\r\n          alert(message);\r\n  \r\n        },\r\n        error => {\r\n          console.error(error);\r\n          const message = `Error adding need to the basket`;\r\n          alert(message);\r\n        }\r\n      );\r\n    } else {\r\n      const message = `Cannot add need to the basket since the quantity is already at 0.`;\r\n      alert(message);\r\n    }\r\n  }  \r\n\r\n  removeFromBasket(need: Needs): void {\r\n    this.helperService.removeSupportedNeed(need.name).subscribe(\r\n      _ => {\r\n        const originalNeed = this.cupboardNeeds.find(n => n.name === need.name);\r\n        if (originalNeed) {\r\n          originalNeed.quantity += 1;\r\n\r\n          this.supportedNeeds = this.supportedNeeds.filter(n => n.name !== need.name);\r\n\r\n          const message = `Removing need from basket`;\r\n          alert(message);\r\n\r\n          this.cupboardService.removeFromBasket(need);\r\n        } else {\r\n          const message = `Original need not found in cupboard`;\r\n          alert(message);\r\n        }\r\n      },\r\n      error => {\r\n        console.error(error);\r\n        const message = `Error removing need from basket`;\r\n        alert(message);\r\n      }\r\n    );\r\n  }\r\n\r\n  checkout(): void {\r\n    this.helperService.checkOut().subscribe(\r\n      _ => {\r\n        this.supportedNeeds = [];\r\n        this.getCupboardNeeds();\r\n\r\n        const message = 'Checkout Successful!';\r\n        alert(message);\r\n      },\r\n      error => {\r\n        console.error(error);\r\n        const message = 'Error during checkout';\r\n        alert(message);\r\n      }\r\n    );\r\n  }\r\n\r\n  addHelperMessage(message:string): void{\r\n    let username = this.currentUser;\r\n    username = username.trim();\r\n    message = message.trim();\r\n    if (!message) { return; }\r\n    this.messageService.addMessage({username,message} as HelperMessage).subscribe();\r\n  }\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}